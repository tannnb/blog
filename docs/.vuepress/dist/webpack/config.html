<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>参数配置 | 黑娃 ● 知识库</title>
    <meta name="description" content="">
    <link rel="icon" href="/blog/favicon.ico">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/favicon.ico">
    <link rel="mask-icon" href="/blog/favicon.ico" color="#3eaf7c">
    <link rel="dns-prefetch" href="https://tannnb.github.io/blog/">
    <link rel="prerender" href="https://tannnb.github.io/blog/">
    <meta name="description" content="知识库强，则技术强，技术强则国强">
    <meta name="msapplication-TileImage" content="/favicon.ico">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/blog/assets/css/0.styles.48a0ee12.css" as="style"><link rel="preload" href="/blog/assets/js/app.6840529f.js" as="script"><link rel="preload" href="/blog/assets/js/2.11a5d5e3.js" as="script"><link rel="preload" href="/blog/assets/js/3.dc5724bf.js" as="script"><link rel="preload" href="/blog/assets/js/45.8158993f.js" as="script"><link rel="preload" href="/blog/assets/js/4.66589091.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.fecf8860.js"><link rel="prefetch" href="/blog/assets/js/11.029e3ba7.js"><link rel="prefetch" href="/blog/assets/js/12.824cb017.js"><link rel="prefetch" href="/blog/assets/js/13.624c30f7.js"><link rel="prefetch" href="/blog/assets/js/14.426051a6.js"><link rel="prefetch" href="/blog/assets/js/15.795a90e5.js"><link rel="prefetch" href="/blog/assets/js/16.40e78b0c.js"><link rel="prefetch" href="/blog/assets/js/17.ee43b362.js"><link rel="prefetch" href="/blog/assets/js/18.ee9fb776.js"><link rel="prefetch" href="/blog/assets/js/19.3b9ef262.js"><link rel="prefetch" href="/blog/assets/js/20.97bdde46.js"><link rel="prefetch" href="/blog/assets/js/21.c4667805.js"><link rel="prefetch" href="/blog/assets/js/22.af37b567.js"><link rel="prefetch" href="/blog/assets/js/23.1a2cb92b.js"><link rel="prefetch" href="/blog/assets/js/24.40f8b4fb.js"><link rel="prefetch" href="/blog/assets/js/25.f1f2b77f.js"><link rel="prefetch" href="/blog/assets/js/26.967eeb52.js"><link rel="prefetch" href="/blog/assets/js/27.f35d832b.js"><link rel="prefetch" href="/blog/assets/js/28.6304848a.js"><link rel="prefetch" href="/blog/assets/js/29.307fd86f.js"><link rel="prefetch" href="/blog/assets/js/30.591c9baa.js"><link rel="prefetch" href="/blog/assets/js/31.beadbffd.js"><link rel="prefetch" href="/blog/assets/js/32.9f84e0c8.js"><link rel="prefetch" href="/blog/assets/js/33.7f0429d5.js"><link rel="prefetch" href="/blog/assets/js/34.803cbed1.js"><link rel="prefetch" href="/blog/assets/js/35.2d6aa872.js"><link rel="prefetch" href="/blog/assets/js/36.848e7f90.js"><link rel="prefetch" href="/blog/assets/js/37.7f01a87c.js"><link rel="prefetch" href="/blog/assets/js/38.28c19fe0.js"><link rel="prefetch" href="/blog/assets/js/39.e4061a03.js"><link rel="prefetch" href="/blog/assets/js/40.3cdbb3ae.js"><link rel="prefetch" href="/blog/assets/js/41.9fcac76b.js"><link rel="prefetch" href="/blog/assets/js/42.111583c0.js"><link rel="prefetch" href="/blog/assets/js/43.620cd84c.js"><link rel="prefetch" href="/blog/assets/js/44.723b4dc3.js"><link rel="prefetch" href="/blog/assets/js/46.132fa256.js"><link rel="prefetch" href="/blog/assets/js/47.3be3b891.js"><link rel="prefetch" href="/blog/assets/js/48.f7db10ca.js"><link rel="prefetch" href="/blog/assets/js/49.bd0ddb4e.js"><link rel="prefetch" href="/blog/assets/js/5.6a045548.js"><link rel="prefetch" href="/blog/assets/js/6.9358a351.js"><link rel="prefetch" href="/blog/assets/js/7.cd67eb81.js"><link rel="prefetch" href="/blog/assets/js/8.7cc0cfa5.js"><link rel="prefetch" href="/blog/assets/js/9.3d8caf25.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.48a0ee12.css">
</head>
<body>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">黑娃 ● 知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/interview/base/" class="nav-link">
  前端学习
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习记录" class="dropdown-title"><span class="title">学习记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习记录" class="mobile-dropdown-title"><span class="title">学习记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          CSS系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/style/" class="nav-link">
  常用CSS样式
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/javascript/es6.html" class="nav-link">
  深入理解ES6
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/know_top.html" class="nav-link">
  你不知道的JavaScript(上)
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/know_in.html" class="nav-link">
  你不知道的JavaScript(中)
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/algorithm.html" class="nav-link">
  JavaScript数据结构和算法
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/utils.html" class="nav-link">
  常用方法
</a></li></ul></li><li class="dropdown-item"><h4>
          typescript系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/typescript/" class="nav-link">
  typescript
</a></li></ul></li><li class="dropdown-item"><h4>
          Git系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/git/" class="nav-link">
  精通Git
</a></li></ul></li><li class="dropdown-item"><h4>
          nodejs系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/nodejs/npm.html" class="nav-link">
  npm配置
</a></li></ul></li><li class="dropdown-item"><h4>
          webpack系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/webpack/" class="nav-link router-link-active">
  webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/framework/" class="nav-link">
  脚手架学习
</a></div><div class="nav-item"><a href="http://www.tannnb.com/pc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  播放器
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/tannnb" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/interview/base/" class="nav-link">
  前端学习
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习记录" class="dropdown-title"><span class="title">学习记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习记录" class="mobile-dropdown-title"><span class="title">学习记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          CSS系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/style/" class="nav-link">
  常用CSS样式
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/javascript/es6.html" class="nav-link">
  深入理解ES6
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/know_top.html" class="nav-link">
  你不知道的JavaScript(上)
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/know_in.html" class="nav-link">
  你不知道的JavaScript(中)
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/algorithm.html" class="nav-link">
  JavaScript数据结构和算法
</a></li><li class="dropdown-subitem"><a href="/blog/javascript/utils.html" class="nav-link">
  常用方法
</a></li></ul></li><li class="dropdown-item"><h4>
          typescript系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/typescript/" class="nav-link">
  typescript
</a></li></ul></li><li class="dropdown-item"><h4>
          Git系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/git/" class="nav-link">
  精通Git
</a></li></ul></li><li class="dropdown-item"><h4>
          nodejs系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/nodejs/npm.html" class="nav-link">
  npm配置
</a></li></ul></li><li class="dropdown-item"><h4>
          webpack系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/webpack/" class="nav-link router-link-active">
  webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/framework/" class="nav-link">
  脚手架学习
</a></div><div class="nav-item"><a href="http://www.tannnb.com/pc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  播放器
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/tannnb" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>webpack学习记录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/webpack/" aria-current="page" class="sidebar-link">前置概念</a></li><li><a href="/blog/webpack/initWebpack.html" class="sidebar-link">初始化webpack</a></li><li><a href="/blog/webpack/config.html" aria-current="page" class="active sidebar-link">参数配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#entry-和-output" class="sidebar-link">entry 和 output</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#mode" class="sidebar-link">mode</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#devtool" class="sidebar-link">devtool</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#module" class="sidebar-link">module</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#plugins" class="sidebar-link">plugins</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#html模板" class="sidebar-link">HTML模板</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#清理打包路径" class="sidebar-link">清理打包路径</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#本地服务" class="sidebar-link">本地服务</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#css处理-css-loader" class="sidebar-link">CSS处理(css-loader)</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#css添加浏览器前缀" class="sidebar-link">CSS添加浏览器前缀</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#压缩css代码" class="sidebar-link">压缩CSS代码</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#css预处理器" class="sidebar-link">CSS预处理器</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#静态资源处理" class="sidebar-link">静态资源处理</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#资源模块" class="sidebar-link">资源模块</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#配置babel处理es6" class="sidebar-link">配置Babel处理es6</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#配置react" class="sidebar-link">配置React</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#文件归类" class="sidebar-link">文件归类</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#哈希值" class="sidebar-link">哈希值</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#哈希值-hash策略" class="sidebar-link">哈希值-hash策略</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#哈希值-chunkhash策略" class="sidebar-link">哈希值-chunkHash策略</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#哈希值-contenthash策略" class="sidebar-link">哈希值-contenthash策略</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#alias命名" class="sidebar-link">alias命名</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#include与exclude" class="sidebar-link">include与exclude</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#noparse" class="sidebar-link">noParse</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#happypack开启多进程loader" class="sidebar-link">HappyPack开启多进程Loader</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#代码压缩" class="sidebar-link">代码压缩</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#配置缓存" class="sidebar-link">配置缓存</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#analyzer打包大小分析" class="sidebar-link">analyzer打包大小分析</a></li></ul></li><li><a href="/blog/webpack/loader.html" class="sidebar-link">自定义Loader</a></li><li><a href="/blog/webpack/plugin.html" class="sidebar-link">自定义插件</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="参数配置"><a href="#参数配置" class="header-anchor">#</a> 参数配置</h1> <p>webpack其实有一个配置文件 (webpack.config.js)</p> <div class="custom-block warning"><p class="custom-block-title">但为什么前面的初始化测试时，我们没有编辑配置文件却可以成功打包？</p> <p>这是因为webpack会有一个默认配置，当它检测到我们没有配置文件的时候，它默认会使用自己的默认配置。</p></div> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 默认配置大概长这样</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="entry-和-output"><a href="#entry-和-output" class="header-anchor">#</a> entry 和 output</h2> <p><code>entry</code>是用来配置入口文件的，他可以是字符串,数组或者对象类型。webpack默认只支持<code>js</code>和<code>json</code>文件作为入口文件</p> <p><code>output</code>选项是设置输出配置，该选项必须是对象类型，不能是其它类型格式。在output对象中，必填的两个选项就是导出路径path和导出bundle文件名称filename。其中path选项必须为绝对路径。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1.单入口输出</span>
<span class="token comment">// 完整写法 { main:'./src/index.js' }</span>
<span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2.多入口单输出</span>
<span class="token comment">// 注:当项目需要有多个入口文件，但只需要一个输出bundle的时候，这时候entry可以使用数组的形式</span>
<span class="token punctuation">{</span> 
    entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./src/index_1.js'</span><span class="token punctuation">,</span> <span class="token string">'./src/index_2.js'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 3.多入口多输出</span>
<span class="token punctuation">{</span>
    index<span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// chunkName为index</span>
    main<span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span>     <span class="token comment">// chunkName为main </span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>针对对入口方式，我们的output。filename不能写死一个固定文件，这时webpack提供了一个占位符<code>[name]</code>给我们使用,他会制动替换为对应的chunkName</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span>  <span class="token comment">// [name]占位符会自动替换为chunkName</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>1.在单入口输出的场景下，<code>entry</code>也可以使用对象的形式，从而来自定义<code>chunkName</code>，然后<code>output.filename</code>也使用<code>[name]</code>占位符来自动匹配。当然也可以使用数组</li> <li>2.当<code>entry</code>使用数组或字符串的时候，<code>chunkName默认为main</code>，<b>因此如果<code>output.filename</code>使用<code>[name]</code>占位符的时候，也会自动替换为main</b>。</li></ul> <h2 id="mode"><a href="#mode" class="header-anchor">#</a> mode</h2> <p>在前面的打包测试的时候，命令行都会报一个警告：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>The <span class="token string">'mode'</span> option has not been set, webpack will fallback to <span class="token string">'production'</span> <span class="token keyword">for</span> this value.
Set <span class="token string">'mode'</span> option to <span class="token string">'development'</span> or <span class="token string">'production'</span> to <span class="token builtin class-name">enable</span> defaults <span class="token keyword">for</span> each environment.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这是因为webpack需要我们配置<code>mode</code>选项，如果不配置则将会有警告提示：</p> <p>webpack给我们提供了三个选项，即<code>none</code>、<code>development</code>和<code>production</code>，而默认就是<code>production</code></p> <p>区别：于webpack自带的代码压缩和优化插件使用</p> <ul><li><p><code>none</code>：不使用任何默认优化选项；</p></li> <li><p><code>development</code>：指的是开发环境，会默认开启一些有利于开发调试的选项，比如NamedModulesPlugin和NamedChunksPlugin，分别是给module和chunk命名的，而默认是一个数组，对应的chunkName也只是下标，不利于开发调试</p></li> <li><p><code>production</code>：指的是生产环境，则会开启代码压缩和代码性能优化的插件，从而打包出来的文件也相对none和development小很多</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">当我们设置mode之后，我们可以在process.env.NODE_ENV获取到当前的环境</p> <p>另一种方式则是在命令行中加上mode配置方式:<code>--mode</code></p> <p><code>&quot;build&quot;:&quot;webpack --mode production&quot;</code></p></div> <h2 id="devtool"><a href="#devtool" class="header-anchor">#</a> devtool</h2> <p>开启sourceMap调试，与代码映射位置。而我们可以在配置文件中，使用devtool开启它</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devtool<span class="token operator">:</span> <span class="token string">&quot;source-map&quot;</span>  <span class="token comment">// 开启source-map</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>由于配置项太多，这里只说最常见的几项,完整配置可查看 <a href="https://webpack.docschina.org/configuration/devtool/#root" target="_blank" rel="noopener noreferrer">webpack/devtool<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>none：不会生成sourceMap；</p></li> <li><p>eval：每个模块都会使用eval()执行，不建议生成环境中使用；</p></li> <li><p>cheap-source-map：生成sourceMap，但是没有列映射，则只会提醒是在代码的第几行，不会提示到第几列；</p></li> <li><p>inline-source-map：会生成sourceMap，但不会生成map文件，而是将sourceMap放在打包文件中。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">建议配置</p> <h5 id="开发时可以配置cheap-module-eval-source-map方便调试错误与定位"><a href="#开发时可以配置cheap-module-eval-source-map方便调试错误与定位" class="header-anchor">#</a> 开发时可以配置cheap-module-eval-source-map方便调试错误与定位</h5> <p>devtool: 'cheap-module-eval-source-map'</p> <h5 id="生产时一般关闭devtool-或者使用-cheap-module-source-map"><a href="#生产时一般关闭devtool-或者使用-cheap-module-source-map" class="header-anchor">#</a> 生产时一般关闭devtool 或者使用 cheap-module-source-map</h5> <p>devtool: 'cheap-module-source-map'</p></div> <h2 id="module"><a href="#module" class="header-anchor">#</a> module</h2> <p>前面有提到过，webpack的入口文件只能接收<code>JavaScript</code>文件和<code>JSON</code>文件</p> <p>但我们通常项目还会有其他类型的文件，比如html、css、图片、字体等等，这时候我们就需要用到第三方loader来帮助webpack来解析这些文件。</p> <p>理论上只要有相应的loader，就可以处理任何类型的文件。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在<a href="https://webpack.docschina.org/loaders/" target="_blank" rel="noopener noreferrer">webpack/loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中其实提供了很多loader，已经能满足我们日常使用。</p> <p>或者也可以去github找他人写的loader或者自己手写loader来使用。</p></div> <p>而对于<code>loader</code>的配置，是写在<code>module</code>配置内的。<code>module</code>选项是一个对象，它里面有一个<code>rules</code>属性，是一个数组，在里面我们可以配置多个匹配规则。</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
    module<span class="token operator">:</span><span class="token punctuation">{</span>
        rules<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  <span class="token comment">// 识别css文件</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>  <span class="token comment">// 对css文件使用的三个loader</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">use顺序要求</p> <p>对于use数组的顺序是有要求的，webpack会根据从右到左(从下到上)的规则去执行loader。也就是说，上面的例子webpack会先执行css-loader，再执行style-loader。</p></div> <p>如果我们需要对对应loader提供配置的时候，我们可以选用对象写法：</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
          use<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'style-loader'</span><span class="token punctuation">,</span> 
            <span class="token punctuation">{</span>
               <span class="token comment">// loader名称</span>
               loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
               <span class="token comment">// loader选项</span>
               options<span class="token operator">:</span> <span class="token punctuation">{</span>
                   <span class="token operator">...</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="plugins"><a href="#plugins" class="header-anchor">#</a> plugins</h2> <p>webpack还提供了一个<code>plugins</code>选项，让我们可以使用一些第三方插件，因此我们可以使用第三方插件来实现打包优化、资源管理、注入环境变量等任务。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在<a href="https://webpack.docschina.org/plugins/#root" target="_blank" rel="noopener noreferrer">webpack/plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中其实提供了很多plugin。</p></div> <p>plugins选项是一个数组，里面可以放入多个plugin插件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">TxtWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>对于plugins数组对排序位置是没有要求，因为在plugin的实现中，webpack会通过打包过程的生命周期钩子，因此在插件逻辑中就已经设置好需要在哪个生命周期执行哪些任务。</p></div> <h2 id="html模板"><a href="#html模板" class="header-anchor">#</a> HTML模板</h2> <p>插件场景引运用: <code>html-webpack-plugin</code></p> <p>使用场景:</p> <p>当我们是Web项目的时候，我们必然会存在html文件去实现页面。</p> <p>而对于其他类型的文件，比如css、图片、文件等等，我们是可以通过引入入口js文件，然后通过loader进行解析打包。 而对于html文件，我们不可能将其引入到入口文件然后解析打包，反而我们还需要将打包出来的bundle文件引入html文件去使用，</p> <p>因此，其实我们需要实现的操作只有两个，一个是复制一份html文件到打包路径下，另一个就是将打包出来的bundle文件自动引入到html文件中去。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> html-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>在src文件下新建index.html</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="2"><li>接下来配置一下webpack。一般plugin插件都是一个类，而我们需要在plugins选项中需要创建一个插件实例。对于htmlWebpackPlugin插件，我们需要传入一些配置：</li></ol> <ul><li>html模板地址<code>template</code>和打包出来的文件名<code>filename</code>。</li></ul> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> htmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token comment">// 使用htmlWebpackPlugin插件</span>
        <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>    <span class="token comment">// 指定html模板</span>
            filename<span class="token operator">:</span> <span class="token string">'index.html'</span>  <span class="token comment">// 自定义打包的文件名</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>接下来执行一下打包，就会发现dist文件下会生成一个index.html。打开会发现，webpack会自动将打包后的bundle文件引入(这里bundle名为index)：</p> <div class="language-html line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果我们有多个chunk的时候，我们可以指定该html要引入哪些chunk。在htmlWebpackPlugin配置中有一个chunks选项，是一个数组，你只需要加入你想引入的chunkName即可</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> htmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
       index<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
       main<span class="token operator">:</span> <span class="token string">'./src/main.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>  
            filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
            chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span>  <span class="token comment">// 只引入index chunk</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>打包完成后，dist文件下会出现<code>index.html</code>、<code>index.js</code>和<code>main.js</code>，但是<code>index.html</code>只会引入<code>index.js</code>。</p> <blockquote><p>实现多页面的话，只需要再new一个htmlWebpackPlugin实例即可</p></blockquote> <details class="custom-block details"><summary>简易多页配置</summary> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> htmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span><span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
        main<span class="token operator">:</span><span class="token string">'./src/main.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 使用htmlWebpackPlugin插件</span>
        <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 指定html模板</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 只引入index chunk</span>
            filename<span class="token operator">:</span> <span class="token string">'index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 指定html模板</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            <span class="token comment">// chunks: [&quot;main&quot;],  // 如果不指定，会引入index.js main.js等bundle</span>
            filename<span class="token operator">:</span> <span class="token string">'main.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></details> <h2 id="清理打包路径"><a href="#清理打包路径" class="header-anchor">#</a> 清理打包路径</h2> <p>在每次打包前，我们其实都需要去清空一下打包路径的文件。</p> <p>如果文件重名的话，webpack还会自动覆盖，但是实际中我们都会在打包文件名称中加入哈希值，因此必须清空文件重新生成。</p> <p>这时候我们需要使用一个插件——<code>clean-webpack-plugin</code>。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> clean-webpack-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加配置</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>CleanWebpackPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
        publicPath<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 使用CleanWebpackPlugin</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>有些情况下，我们不需要完全清空打包路径，这时候我们可以使用到一个选项，叫<code>cleanOnceBeforeBuildPatterns</code>，它是一个数组，默认是<code>[**/*]</code>，也就是清理output.path路径下所有东西。</p> <p>而你可以在里面输入只想删除的文件，同时我们可以输入不想删除的文件，只需要在前面加上一个<code>!</code>。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p><code>cleanOnceBeforeBuildPatterns</code>这个选项是可以删除打包路径下之外的文件，只需要你配上绝对路径的话。</p> <p>因此CleanWebpackPlugin还提供了一个选项供测试——dry，默认是为false，当你设置为true后，它就不会真正的执行删除，而是只会在命令行打印出被删除的文件，</p> <p>这样子更好的避免测试过程中误删。</p></div> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// 完整配置</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>CleanWebpackPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
        publicPath<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            dry<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">// 不会真正执行删除动作</span>
            cleanOnceBeforeBuildPatterns<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">'**/*'</span><span class="token punctuation">,</span>  <span class="token comment">// 删除dist路径下所有文件</span>
                <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">!package.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>  <span class="token comment">// 不删除dist/package.json文件</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="本地服务"><a href="#本地服务" class="header-anchor">#</a> 本地服务</h2> <p>当我们使用webpack的时候，不仅仅只是用于打包文件，大部分我们还会依赖webpack来搭建本地服务，同时利用其<code>热更新</code>的功能，让我们更好的开发和调试代码。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> webpack-dev-server -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>开启服务2中方式</p> <ul><li><ol><li><code>npx webpack serve</code></li></ol></li> <li><ol start="2"><li>package.json配置script命令<code>{ &quot;serve&quot;: &quot;webpack serve&quot;}</code>, 然后通过npm run serve || yarn serve运行</li></ol></li></ul> <p>这时，webpack会默认开启<code>http://localhost:8080/</code>服务，而该服务指向的是dist/index.html。</p> <p>但你会发现，你的dist中其实是没有任何文件的，这是因为webpack将实时编译后的文件都保存到了内存当中。</p> <h4 id="webpack-dev-server优点"><a href="#webpack-dev-server优点" class="header-anchor">#</a> webpack-dev-server优点</h4> <details class="custom-block details"><summary>webpack自带提供了 --watch 命令，可以实现动态监听文件的改变并实时打包，输出新的打包文件，但这种方案存在着几个缺点</summary> <p>1.每次进行修改代码，webpack就会全部文件进行重新打包，这时候每次更新打包的速度就会慢了很多</p> <ol start="2"><li>其次，这样的监听方式做不到热更新，即每次你修改代码后，webpack重新编译打包后，你就得手动刷新浏览器，才能看到最新的页面结果。</li></ol></details> <details class="custom-block details"><summary>而webpack-dev-server，却有效了弥补这两个问题</summary> <p>1.webpack-dev-server使用了express启动了一个http服务器，并且引入资源文件</p> <p>2.然后这个http服务器和客户端使用了websocket通讯协议，当原始文件作出改动后，webpack-dev-server就会实时编译，然后将最后编译文件实时渲染到页面上</p></details> <h4 id="webpack-config-js中-有一个devserver选项是用来配置webpack-dev-server-这里简单介绍几个比较常用的配置。webpack-devserver"><a href="#webpack-config-js中-有一个devserver选项是用来配置webpack-dev-server-这里简单介绍几个比较常用的配置。webpack-devserver" class="header-anchor">#</a> webpack.config.js中，有一个<code>devServer</code>选项是用来配置webpack-dev-server，这里简单介绍几个比较常用的配置。<a href="https://webpack.docschina.org/configuration/dev-server/#root" target="_blank" rel="noopener noreferrer">webpack/DevServer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">// 配置webpack-dev-server</span>
    <span class="token string">&quot;devServer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    
        port<span class="token operator">:</span> <span class="token number">8888</span><span class="token punctuation">,</span>
        proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token string">'http://localhost:9000'</span><span class="token punctuation">,</span>  <span class="token comment">// 代理地址</span>
            <span class="token string">'pathRewrite'</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token comment">// 重写路径</span>
             secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// 使用https</span>
             changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>   <span class="token comment">// 覆盖主机源</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// port: 设置服务器端口号</span>
<span class="token comment">// open: 默认是为false，当你设置为true的时候，你每次运行webpack-dev-server就会自动帮你打开浏览器</span>
<span class="token comment">// proxy: 设置本地开发的跨域代理。(proxy的值必须是一个对象，在里面我们可以配置一个或多个跨域代理)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><details class="custom-block details"><summary>proxy配置信息那点事儿</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 当你请求/api/users的时候，就会代理到http://localhost:9000/api/users</span>

<span class="token comment">// 如果配置了pathRewrite,比如{ '^/api': '' } ,那么请求/api/users的时候，就会代理到http://localhost:3000/users</span>

<span class="token comment">// changeOrigin: 默认情况下，代理时会保留主机头的来源，当我们将其设置为true可以覆盖这种行为</span>

<span class="token comment">// secure: 当你的接口使用了https的时候，需要将其设置为false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></details> <h2 id="css处理-css-loader"><a href="#css处理-css-loader" class="header-anchor">#</a> CSS处理(css-loader)</h2> <p>我们解析css需要用到的loader有<code>css-loader</code>和<code>style-loader</code>。css-loader主要用来解析css文件，而style-loader是将css渲染到DOM节点上</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> css-loader style-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>操作步骤</summary> <ol><li>在src下新建一个css文件</li></ol> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>在index.js 引入该css文件</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./index.css'</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello webpack 5'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="3"><li>配置css-loader</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token operator">...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  <span class="token comment">// 识别css文件</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>  <span class="token comment">// 先使用css-loader,再使用style-loader</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></details> <p>执行打包命令，会发现dist路径下只有main.js和index.html。使用配置好的devServer来快速启动查看效果，此时打开页面发现css已经生效了。</p> <div class="custom-block warning"><p class="custom-block-title">为什么没有看到打包后的css文件呢?</p> <p>这是因为style-loader是将css代码插入到了main.js当中去了</p></div> <h4 id="那么我们不想将css代码放进js中-而是直接导出一份或多份css文件-那该怎么做-这就得使用另一个插件-mini-css-extract-plugin"><a href="#那么我们不想将css代码放进js中-而是直接导出一份或多份css文件-那该怎么做-这就得使用另一个插件-mini-css-extract-plugin" class="header-anchor">#</a> 那么我们不想将css代码放进js中，而是直接导出一份或多份css文件，那该怎么做？ 这就得使用另一个插件—— <code>mini-css-extract-plugin</code></h4> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> miniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span>
                    miniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>  <span class="token comment">// 使用miniCssExtractPlugin.loader替换style-loader</span>
                    <span class="token string">'css-loader'</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           filename<span class="token operator">:</span> <span class="token string">&quot;[name].css&quot;</span>  <span class="token comment">// 设置导出css名称，[name]占位符对应chunkName</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 注:这里我们不再使用style-loader，而是使用miniCssExtractPlugin提供的loader</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="接下来打包一下-dist路径下就会多出一个main-css文件-并且在index-html中也会自动引入"><a href="#接下来打包一下-dist路径下就会多出一个main-css文件-并且在index-html中也会自动引入" class="header-anchor">#</a> 接下来打包一下，dist路径下就会多出一个main.css文件，并且在index.html中也会自动引入</h4> <div class="language-html line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="css添加浏览器前缀"><a href="#css添加浏览器前缀" class="header-anchor">#</a> CSS添加浏览器前缀</h2> <p>当我们使用一下css新特性的时候，可能需要考虑到浏览器兼容的问题，这时候可能需要对一些css属性添加浏览器前缀。而这类工作，其实可以交给webpack去实现。准确来说，是交给<code>postcss</code>去实现。</p> <blockquote><p>postcss对于css 等于 babel对于JavaScript，它专注于对转换css，比如添加前缀兼容、压缩css代码等等</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> postcss postcss-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>配置步骤与解释</summary> <ol><li>首先在webpack配置文件先引入postcss-loader，它的顺序必须要在css-loader之前执行</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 引入postcss-loader</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>miniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2.接下来配置postcss的工作，就不在webpack的配置文件里面了。 postcss自身也是有配置文件的，我们需要在项目根路径下新建一个postcss.config.js。</p> <p>然后里面也有一个配置项，为plugins这也意味着，postcss自身也支持很多第三方插件使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="3"><li>我们想实现的添加前缀的功能，需要安装的插件叫<code>autoprefixer</code>。</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> autoprefixer -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 将css编译为适应于多版本浏览器</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 覆盖浏览器版本</span>
            <span class="token comment">// last 2 versions: 兼容各个浏览器最新的两个版本</span>
            <span class="token comment">// &gt; 1%: 浏览器全球使用占有率大于1%</span>
            overrideBrowserslist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'last 2 versions'</span><span class="token punctuation">,</span> <span class="token string">'&gt; 1%'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="关于overridebrowserslist的选项-我们可以去参考一下browserslist。"><a href="#关于overridebrowserslist的选项-我们可以去参考一下browserslist。" class="header-anchor">#</a> 关于overrideBrowserslist的选项，我们可以去参考一下browserslist。</h4> <p>此时我们打包出来的css如下</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -ms-flexbox<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></details> <h2 id="压缩css代码"><a href="#压缩css代码" class="header-anchor">#</a> 压缩CSS代码</h2> <p>当我们需要压缩css代码的时候，可以使用postcss另一个插件——<code>cssnano</code>。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> cssnano -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>还是在配置文件<code>postcss.config.js</code>中引入</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="打包之后css压缩代码"><a href="#打包之后css压缩代码" class="header-anchor">#</a> 打包之后css压缩代码</h4> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span><span class="token punctuation">{</span><span class="token property">display</span><span class="token punctuation">:</span>-webkit-box<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span>-ms-flexbox<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span>flex<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="css预处理器"><a href="#css预处理器" class="header-anchor">#</a> CSS预处理器</h2> <p>在我们实际开发中，我们会更多使用<code>Sass</code>、<code>Less</code>或者<code>stylus</code>这类css预处理器。而其实html是无法直接解析这类文件的，因此我们需要使用对应的loader将其转换成css</p> <blockquote><p>本人日常使用最多的是sass, 就以<code>sass</code>为例，来讲一下如何使用webpack解析sass</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> sass sass-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>sass-loader 配置步骤与解释</summary> <ol><li>在module加上sass的匹配规则，sass-loader的执行顺序应该是排第一，我们需要先将其转换成css，然后才能执行后续的操作,比如添加前缀等</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|scss|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  <span class="token comment">// 识别css scss less文件</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>miniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>  <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token comment">// 先转换scss文件为css，然后给css添加前缀, 然后解析css文件，最后将css输出单独文件并挂载到html上</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>3.在src下新建一个variable.scss,并且在index.js中引入</p> <div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token property"><span class="token variable">$color-white</span></span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token property"><span class="token variable">$color-black</span></span><span class="token punctuation">:</span> #222<span class="token punctuation">;</span>

<span class="token selector">body </span><span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token variable">$color-black</span><span class="token punctuation">;</span>

  <span class="token selector">div </span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$color-white</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>4.执行打包，再看看打包出来的index.css，scss文件内容被解析到里面，同时如果我们引入多个css或css预处理器文件的话，miniCssExtractPlugin也会将其打包成一个bundle文件里面</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#app</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>aqua<span class="token punctuation">}</span>
<span class="token selector">body</span><span class="token punctuation">{</span><span class="token property">background</span><span class="token punctuation">:</span>#222<span class="token punctuation">}</span><span class="token selector">body div</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-scss line-numbers-mode"><pre class="language-scss"><code>import <span class="token string">'./index.css'</span>
import <span class="token string">'./variable.scss'</span>
console.<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello webpack 5'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></details> <div class="custom-block warning"><p class="custom-block-title">node-sass 下载失败 解决方案</p> <p>在项目下添加.npmrc 或者 .yarnrc 并填写下方地址信息</p> <p>sass_binary_site=https://npm.taobao.org/mirrors/node-sass/</p> <p>registry=https://registry.npm.taobao.org</p></div> <h2 id="静态资源处理"><a href="#静态资源处理" class="header-anchor">#</a> 静态资源处理</h2> <p>当我们使用了图片、视频或字体等等其他静态资源的话，我们需要用到<code>url-loader</code>和<code>file-loader</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> url-loader file-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>首先我们在项目中引入一张图片，然后在引入到index.js中。</p> <details class="custom-block details"><summary>url-loader 配置与解释</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> pic <span class="token keyword">from</span> <span class="token string">&quot;./image.png&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src<span class="token operator">=</span> pic<span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'url-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="此时dist路径下没有图片文件-但是你打开页面是可以看到图片的-且通过调试工具-我们可以看到其实url-loader默认会将静态资源转成base64"><a href="#此时dist路径下没有图片文件-但是你打开页面是可以看到图片的-且通过调试工具-我们可以看到其实url-loader默认会将静态资源转成base64" class="header-anchor">#</a> 此时dist路径下没有图片文件，但是你打开页面是可以看到图片的，且通过调试工具，我们可以看到其实url-loader默认会将静态资源转成base64</h4> <p><code>url-loader</code>选项有提供一个属性，叫<code>limit</code>，就是我们可以设置一个文件大小阈值，当文件大小超过这个值的时候，<code>url-loader</code>就不会转成<code>base64</code>，而是直接打包成文件。执行打包,可以看到dist目录下出现了图片文件</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>   <span class="token comment">// 使用占位符设置导出名称</span>
            limit<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span>        <span class="token comment">// 设置转成base64阈值，大于10k不转成base64</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="那么如果我项目中存在视频文件-字体文件该怎么打包呢"><a href="#那么如果我项目中存在视频文件-字体文件该怎么打包呢" class="header-anchor">#</a> 那么如果我项目中存在视频文件，字体文件该怎么打包呢?</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 图片</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            esModule<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>
            limit<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 字体</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff2?|eot|ttf|otf)(\?.*)?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>
            limit<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 媒体文件</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>
            limit<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></details> <details class="custom-block details"><summary>file-loader其实跟url-loader差不多，但它默认就是导出文件，而不会导出base64的</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'file-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>会发现dist文件夹下依旧会打包成一个图片文件，但是它的名称会被改成哈希值，但是我们可以通过options选项来设置导出的名称</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>   <span class="token comment">// 使用占位符设置导出名称,如果不设置那么名称是自动生成的hash值</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></details> <div class="custom-block warning"><p class="custom-block-title">问题：如果直接在index.html引入图片的话，可以顺利打包吗？</p> <p>结论：页面找不到该图片地址。</p> <p>运行打包出来的文件，发现<code>&lt;img src=&quot;./image.png&quot;&gt;</code>,浏览器并没有解析和打包出来,这时候需要使用另一个插件 <code>html-withimg-loader</code></p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> html-withimg-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>配置 html-withimg-loader 规则与操作</summary> <ol><li>添加html解析规则，此时直接执行打包命令，图片还是展示不出来。然后通过调试工具看的话，会发现显示的是 <code>&lt;img src=&quot;{&quot;default&quot;:&quot;image.png&quot;}&quot;&gt;</code> 这是什么原因？</li></ol> <p>因为<code>html-loader</code>使用的是<code>commonjs</code>进行解析的，而<code>url-loader</code>默认是使用<code>esModule</code>解析的。因此我们需要设置一下<code>url-loader</code></p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span> 
       test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.html$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
       loader<span class="token operator">:</span> <span class="token string">'html-withimg-loader'</span> 
       <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="2"><li>修改url-loader配置</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|je?pg|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          use<span class="token operator">:</span> <span class="token punctuation">{</span>
              loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
              options<span class="token operator">:</span> <span class="token punctuation">{</span>
                  esModule<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// 不使用esModule解析</span>
                  name<span class="token operator">:</span> <span class="token string">'[name].[ext]'</span><span class="token punctuation">,</span>
                  limit<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>此时在执行打包命令，可以看到图片正常显示出来了，也能正常找到引用地址。</p></details> <h2 id="资源模块"><a href="#资源模块" class="header-anchor">#</a> 资源模块</h2> <p>在webpack5中，新添了一个资源模块，它允许使用资源文件（字体，图标等）而无需配置额外 loader，内容太多 😄 具体的内容查看 <a href="https://webpack.docschina.org/guides/asset-modules/" target="_blank" rel="noopener noreferrer">webpack/asset-modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>前面的例子，我们对静态资源都使用了<code>url-loader</code>或者<code>file-loader</code>，而在webpack5，我们甚至可以需要手动去安装和使用这两个loader，而直接设置一个<code>type</code>属性。</p> <details class="custom-block details"><summary>修改静态资源配置</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token operator">:</span><span class="token punctuation">[</span>
    
    <span class="token comment">// {</span>
    <span class="token comment">//     test: /\.(png|je?pg|gif|webp)$/,</span>
    <span class="token comment">//     use: [{</span>
    <span class="token comment">//         loader: 'url-loader',</span>
    <span class="token comment">//         options: {</span>
    <span class="token comment">//             esModule: false,  // 不使用esModule解析</span>
    <span class="token comment">//             name: '[name].[ext]',   // 使用占位符设置导出名称</span>
    <span class="token comment">//             limit: 1024 * 10  // 设置转成base64阈值，大于10k不转成base64</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }]</span>
    <span class="token comment">// },</span>
    
      <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg|eot|ttf|woff|woff2)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ol start="3"><li>打包出来的文件名师hash值，我们可以配置<code>bundle</code>静态文件名称,此时静态文件名称就显示正常了</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
        assetModuleFilename<span class="token operator">:</span> <span class="token string">'[name][ext]'</span>   <span class="token comment">// 设置静态bundle文件的名称</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>然后打包测试后，静态文件都会直接打包成文件并自动引入，<code>效果跟file-loader一致</code></p> <h4 id="type有4种新的模块类型-来替换所有这些-loader"><a href="#type有4种新的模块类型-来替换所有这些-loader" class="header-anchor">#</a> <code>type</code>有4种新的模块类型,来替换所有这些 loader：</h4> <ul><li><code>asset/resource</code>：发送一个单独的文件并导出 URL。之前通过使用 <code>file-loader</code> 实现。</li> <li><code>asset/inline</code>：导出一个资源的 data URI。之前通过使用 <code>url-loader</code> 实现。</li> <li><code>asset/source</code>：导出资源的源代码。之前通过使用 <code>raw-loader</code> 实现。</li> <li><code>asset</code>：在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过使用 <code>url-loader</code>，并且配置资源体积限制实现。</li></ul></details> <h2 id="配置babel处理es6"><a href="#配置babel处理es6" class="header-anchor">#</a> 配置Babel处理es6</h2> <p>为了兼容多浏览器转义，因此我们需要用到<code>babel</code>, 同时，我们需要使用babel中用于JavaScript兼容的插件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> babel-loader -D

<span class="token function">npm</span> <span class="token function">install</span> @babel/preset-env @babel/core core-js -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><details class="custom-block details"><summary>babel配置与步骤</summary> <ol><li>配置js文件解析转义</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="2"><li>配置babel。当然我们可以直接在<code>webpack.config.js</code>里面配置，但是babel同样也提供了配置文件<code>.babelrc</code>，babel的配置特别多，所以一般会在根目录下创建一个<code>.babelrc</code>文件单独配置</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 浏览器版本</span>
        <span class="token string">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;edge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;17&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;chrome&quot;</span><span class="token operator">:</span> <span class="token string">&quot;67&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 配置corejs版本，但需要额外安装corejs</span>
        <span class="token string">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          
        <span class="token comment">// 加载情况</span>
        <span class="token comment">// entry: 需要在入口文件进入@babel/polyfill，然后babel根据使用情况按需载入</span>
        <span class="token comment">// usage: 无需引入，自动按需加载(推荐)</span>
        <span class="token comment">// false: 入口文件引入，全部载入</span>
        <span class="token string">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ol start="3"><li>在index.js中,编写一些es6的代码打包之后，控制台能正常输出结果</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Hello babel'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">10086</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;客服电话:&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面打包代码是直接使用了<code>Promise</code>,<code>assign</code>，而没有考虑到低版本浏览器的兼容。然后我们打开babel后，执行一下打包命令，会发现代码多出了很多。</p> <p>而在打包代码中，可以看到webpack使用了<code>polyfill(垫片)</code>实现promise类，然后再去调用，从而兼容了低版本浏览器没有promise属性问题</p></details> <h2 id="配置react"><a href="#配置react" class="header-anchor">#</a> 配置React</h2> <p>webpack要解析react需要借助<code>@babel/preset-react</code> 来实现</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/preset-react -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>在.babelrc中配置presets时，注意：一定是从下往上，先执行&quot;@babel/preset-react&quot;解析jsx格式语法，在通过&quot;@babel/preset-env&quot;解析es6成es5的语法</p></div> <p>尝试一下react写法，首先安装核心库<code>react</code>,<code>react-dom</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> react react-dom -S
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在<code>index.js</code>尝试添加如下代码，可以看到页面正正确显示<code>hello React</code>，以及打印出<code>componentDidMount</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>useEffect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentDidMount'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello React<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="文件归类"><a href="#文件归类" class="header-anchor">#</a> 文件归类</h2> <details class="custom-block details"><summary>我们的测试代码中，我们的src文件夹如下：</summary> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── src
│   ├── image.jpg
│   ├── index.html
│   ├── index.js
│   ├── index.css
│   ├── iconfont.css
│   ├── iconfont.ttf
│   └── variable.scss
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></details> <details class="custom-block details"><summary>而正常项目的话，我们会使用文件夹将其分好类,如下方显示</summary> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── src
│   ├── index.html
│   ├── js
│   │   └── index.js
│   ├── static
│   │   └── image.png
│   │   └── iconfont.ttf
│   │   └── iconfont.css
│   └── style
│       ├── index.css
│       └── variable.scss
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></details> <details class="custom-block details"><summary>文件归类步骤与解析</summary> <ol><li>首先，我们先将打包出来的JavaScript文件放入<code>assets</code>文件夹下，我们只需要修改<code>output.filename</code>即可</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'assets/[name].js'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>其次，我们将打包出来的<code>css</code>文件也放入<code>assets</code>路径下，因为我们打包css是使用<code>miniCssExtractPlugin</code>，因此我们只需要配置一下<code>miniCssExtractPlugin</code>的<code>filename</code>即可</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
   plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span>
      <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">&quot;assets/[name].css&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="3"><li>最后就是静态资源了，这里我们使用静态模块方案，所以直接修改<code>output.assetModuleFilename</code>即可</li></ol> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token punctuation">{</span>
   output<span class="token operator">:</span> <span class="token punctuation">{</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'assets/[name].js'</span><span class="token punctuation">,</span>
      assetModuleFilename<span class="token operator">:</span> <span class="token string">'assets/[name][ext]'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>此时打包之后，预览一下页面，发现都正常引入和使用。</p></details> <h2 id="哈希值"><a href="#哈希值" class="header-anchor">#</a> 哈希值</h2> <p>通常，我们打包文件的文件名都需要带上一个哈希值，这会给我们的好处就是<code>避免缓存</code>,webpack也提供了三种哈希值的策略。</p> <h4 id="文件调整"><a href="#文件调整" class="header-anchor">#</a> 文件调整</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> pic <span class="token keyword">from</span> <span class="token string">&quot;../static/image.jpg&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src<span class="token operator">=</span> pic<span class="token punctuation">;</span>
img<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">40</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">'../style/index.css'</span>
<span class="token keyword">import</span> <span class="token string">'../style/variable.scss'</span>


<span class="token comment">// webpack.config.js</span>
entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    main<span class="token operator">:</span> <span class="token string">'./src/js/main.js'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="哈希值-hash策略"><a href="#哈希值-hash策略" class="header-anchor">#</a> 哈希值-hash策略</h2> <p><code>hash策略</code>，是以项目为单位的，也就是说，只要项目一个文件发生改动，首先打包后该文件对应的bundle文件名会改变，其次所有js文件和css文件的文件名也会改变</p> <p>首先我们需要在所有设置<code>filename</code>的地方加入<code>[hash]</code>占位符，同时我们也可以设置哈希值的长度，只需加上冒号和长度值即可，比如<code>[hash:6]</code>。</p> <details class="custom-block details"><summary>配置修改</summary> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
        main<span class="token operator">:</span> <span class="token string">'./src/js/main.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">&quot;assets/[name]-[hash:6].css&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'assets/[name]-[hash:6].js'</span><span class="token punctuation">,</span>
        assetModuleFilename<span class="token operator">:</span> <span class="token string">'assets/[name]-[hash:6][ext]'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>打包之后的文件大概长这样</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-702fc4.jpg
│   ├── index-1c6a2b.js
│   ├── main-1c6a2b.css
│   └── main-1c6a2b.js
└── index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>为么css的名称叫main.css呢?</p> <p>是因为main.js 中引入了css样式，经过webpack打包过程中，执行miniCssExtractPlugin插件钩子，将css代码从js中剔除，生成一个新css文件此时文件名称就为<code>&quot;assets/[name]-[hash:6].css&quot;</code>配置的名称</p></blockquote> <p>修改<code>style.css</code>,在重新打包测试查看文件名称,这时候会发现<code>index.js</code>、<code>main.js</code>、<code>main.css</code>的文件名都会发生改变，但静态文件并不会发生变化</p> <div class="language-text line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-702fc4.jpg
│   ├── index-8739d8.js
│   ├── main-8739d8.css
│   └── main-8739d8.js
└── index.html
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果我更换一张图片，但是文件名不变，会不会改变呢？ 我们找一个其他图片还是命名 <code>image.jpg</code> 然后重新打包;</p> <p>结果如下 <code>index.js</code>、<code>main.js</code>、<code>main.css</code> 的文件名依旧会发生改变，同时<code>image.jpg</code>也发生了变化。</p> <div class="language-text line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-f8ef88.jpg
│   ├── index-5766ac.js
│   ├── main-5766ac.css
│   └── main-5766ac.js
└── index.html
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">通过上面的测试，我们可以简单总结出</p> <ul><li>如果修改项目文件的话，所有的<code>js</code>、<code>css</code>打包文件的文件名都会发生变化，尽管来自多个<code>chunk</code></li> <li>如果修改静态文件的话，该静态文件的打包文件文件名会发生变化，并且所有的<code>js</code>、<code>css</code>打包文件的文件名也都会发生变化</li></ul></div></details> <h2 id="哈希值-chunkhash策略"><a href="#哈希值-chunkhash策略" class="header-anchor">#</a> 哈希值-chunkHash策略</h2> <p>而<code>chunkHash</code>策略的话，是以<code>chunk</code>为单位的，如果一个文件发生变化，只有那条<code>chunk相关的文件</code>的打包文件文件名才会发生变化。</p> <details class="custom-block details"><summary>配置修改</summary> <p><b>! 这里注意的是<code>chunkhash</code>不适用于静态文件，因此静态文件依旧使用<code>hash</code></b></p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
        main<span class="token operator">:</span> <span class="token string">'./src/js/main.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">&quot;assets/[name]-[chunkhash:6].css&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'assets/[name]-[chunkhash:6].js'</span><span class="token punctuation">,</span>
        assetModuleFilename<span class="token operator">:</span> <span class="token string">'assets/[name]-[hash:6][ext]'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>打包结果</p> <div class="language-text line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-f8ef88.jpg
│   ├── index-91dbc3.js
│   ├── main-91dbc3.css
│   └── main-91dbc3.js
└── index.html
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>然后我们首先修改一下<code>style.css</code>，打包一下，会发现<code>main.css</code>和<code>main.js</code>都发生了变化，而<b>index.js不是一个chunk的，因此不会发生变化</b>。</p> <div class="language-text line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-f8ef88.jpg
│   ├── index-91dbc3.js
│   ├── main-7c5a87.css
│   └── main-7c5a87.js
└── index.html
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>同样，我们再覆盖一下image.jpg，再打包一下
这时候<code>image.jpg</code>会发生变化，然后<code>index.js</code>也发生了变化，因为它们是一个chunk的，而<code>main.css</code>和<code>main.js</code>就不会发生变化。</p> <div class="language-text line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-696218.jpg
│   ├── index-9d9520.js
│   ├── main-7c5a87.css
│   └── main-7c5a87.js
└── index.html
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">通过上面的测试，我们可以简单总结出</p> <ul><li>如果修改项目文件的话，该项目文件对应的<code>chunk</code>的<code>js</code>、<code>css</code>打包文件的文件名都会发生变化</li> <li>如果修改静态文件的话，该静态文件的<code>打包文件文件名</code>会发生变化，并且引入该静态文件对应的<code>chunk</code>的<code>js</code>、<code>css</code>打包文件的文件名也都会发生变化</li></ul></div></details> <h2 id="哈希值-contenthash策略"><a href="#哈希值-contenthash策略" class="header-anchor">#</a> 哈希值-contenthash策略</h2> <p><code>contenthash</code>策略， 它是以自身内容为单位的，因此当一个文件发生变化的时候，首先它本身的打包文件的名称会发生变化，其次，引入它的文件的打包文件也会发生变化</p> <p>我们将<code>chunkhash</code>改成<code>contenthash</code></p> <details class="custom-block details"><summary>配置修改</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
        main<span class="token operator">:</span> <span class="token string">'./src/js/main.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token keyword">new</span> <span class="token class-name">miniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">&quot;assets/[name]-[contenthash:6].css&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'assets/[name]-[contenthash:6].js'</span><span class="token punctuation">,</span>
        assetModuleFilename<span class="token operator">:</span> <span class="token string">'assets/[name]-[contenthash:6][ext]'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>打包之后结果</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-696218.jpg
│   ├── index-59cae7.js
│   ├── main-83beab.css
│   └── main-83beab.js
└── index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>同样，我们再覆盖一下image.jpg，再打包一下
这时候<code>image.jpg</code>会发生变化，然后<code>index.js</code>也发生了变化，因为它们是一个chunk的，而<code>main.css</code>和<code>main.js</code>就不会发生变化。
打包之后结果</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-84a8db.jpg
│   ├── index-e043f6.js
│   ├── main-83beab.css
│   └── main-83beab.js
└── index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>同样，我们在编辑一下<code>main.js</code>，</p> <p>在进行打包,查看结果只有<code>main.js</code>的打包文件会发生变化，而处于同个<code>chunk</code>的<code>main.css</code>却不会发生变化，这是因为<code>main.css</code>没有引用<code>main.js</code>。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>├── assets
│   ├── iconfont-73a6ce.ttf
│   ├── iconfont-468e4b.woff
│   ├── iconfont-c601d3.woff2
│   ├── image-84a8db.jpg
│   ├── index-e043f6.js
│   ├── main-83beab.css
│   └── main-d0c1b2.js
└── index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">通过上面的测试，我们可以简单总结出</p> <ul><li>不管是修改项目文件还是静态文件，它本身的打包文件的文件名会发生变化，其次引用该文件的对应打包文件的文件名也会发生变化</li></ul></div></details> <h2 id="alias命名"><a href="#alias命名" class="header-anchor">#</a> alias命名</h2> <p>在配置文件中，其实有一个<code>resovle.alias</code>选项，它可以创建<code>import</code>和<code>require</code>别名，来确保模块引入变得更简单，同时webpack在打包的时候也能更快的找到引入文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置style路径的别名</span>
      style<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/style/'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-js line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'style/index.scss'</span>
<span class="token keyword">import</span> <span class="token string">'../static/iconfont.css'</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="include与exclude"><a href="#include与exclude" class="header-anchor">#</a> include与exclude</h2> <p>当我们使用<code>loader</code>的时候，我们可以配置<code>include</code>来指定只解析该路径下的对应文件，同时我们可以配置<code>exclude</code>来指定不解析该路径下的对应文件。</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>miniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">// 只解析src路径下的css</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span>   <span class="token comment">// 不解析node_modules路径下的js</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="noparse"><a href="#noparse" class="header-anchor">#</a> noParse</h2> <p>在<code>module.noParse</code>选项中，只配置不需要解析的文件。<b>通常我们会忽略一些大型插件从而来提高构建性能</b></p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    noParse<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">jquery|lodash</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="happypack开启多进程loader"><a href="#happypack开启多进程loader" class="header-anchor">#</a> HappyPack开启多进程Loader</h2> <p><code>webpack</code>构建过程中，其实大部分消耗时间都是用到<code>loader</code>解析上面，一方面是因为转换文件数据量很大，另一方面是因为JavaScript单线程特性的原因，因此需要一个个去处理，而不能并发操作</p> <p>而我们可以使用<code>HappyPack</code>，将这部分任务分解到多个子进程中去进行并行处理，子进程处理完成后把结果发送到主进程中去，从而减少总的构建时间。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> happypack  -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;happypack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;os&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> HappyThreadPool <span class="token operator">=</span> HappyPack<span class="token punctuation">.</span><span class="token function">ThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span>size<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'happypack/loader?id=happyBabelLoader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'happyBabelLoader'</span><span class="token punctuation">,</span>  <span class="token comment">// 与loader对应的id标识</span>
      <span class="token comment">// 用法跟loader配置一样</span>
      loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      threadPool<span class="token operator">:</span> HappyThreadPool  <span class="token comment">// 预定义线程池 | shared pool(共享线程池)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="代码压缩"><a href="#代码压缩" class="header-anchor">#</a> 代码压缩</h2> <p>当<code>mode</code>为<code>production</code>的时候，webpack打包会开启代码压缩插件，同时webpack也有提供一个<code>optimization</code>选项，让我们可以使用自己喜欢的插件去覆盖原生插件</p> <p>可以使用<code>webpack-parallel-uglify-plugin</code>来覆盖原生代码压缩插件，它的一个优点就是可以<code>并行执行</code>, <a href="https://github.com/gdborton/webpack-parallel-uglify-plugin" target="_blank" rel="noopener noreferrer">webpack/uglify<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> webpack-parallel-uglify-plugin -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ParallelUglifyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-parallel-uglify-plugin&quot;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">ParallelUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 缓存路径</span>
        cacheDir<span class="token operator">:</span> <span class="token string">'.cache/'</span><span class="token punctuation">,</span>  
        <span class="token comment">// 压缩配置</span>
        uglifyJS<span class="token operator">:</span> <span class="token punctuation">{</span>
          output<span class="token operator">:</span> <span class="token punctuation">{</span>
            comments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            beautify<span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          compress<span class="token operator">:</span> <span class="token punctuation">{</span>
            drop_console<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            collapse_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            reduce_vars<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="配置缓存"><a href="#配置缓存" class="header-anchor">#</a> 配置缓存</h2> <p>每次执行构建都会把所有的文件都重新编译一边，我们可以将这些重复动作缓存下来提高构建速度</p> <p>在<code>Webpack5</code>之前，我们都使用了<code>cache-loader</code>，而在webpack5中，官方提供了一个<code>cache</code>选项给我们带来持久性缓存。</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">let</span> cacheConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'development'</span><span class="token operator">:</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">'memory'</span>  <span class="token comment">// 默认配置</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'production'</span><span class="token operator">:</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">'filesystem'</span><span class="token punctuation">,</span>
        buildDependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
            config<span class="token operator">:</span> <span class="token punctuation">[</span>__filename<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> process <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  cache<span class="token operator">:</span> cacheConfig<span class="token punctuation">[</span>process<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="analyzer打包大小分析"><a href="#analyzer打包大小分析" class="header-anchor">#</a> analyzer打包大小分析</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> webpack-bundle-analyzer -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>BundleAnalyzerPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">analyzer</p> <p>webpack会自动打开一个页面，显示我们打包文件的情况，通过打包报告可以很直观的知道哪些依赖包大，则可以做做针对性的修改</p></div> <p>如果不想每次运行都打开网页的话，我们可以先将数据保存起来，然后要看的时候再执行新的命令去查看</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   analyzerMode<span class="token operator">:</span> <span class="token string">'disabled'</span><span class="token punctuation">,</span>
   generateStatsFile<span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// package.json</span>
<span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-bundle-analyzer --port 3000 ./dist/stats.json&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/webpack/initWebpack.html" class="prev">
        初始化webpack
      </a></span> <span class="next"><a href="/blog/webpack/loader.html">
        自定义Loader
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
<script src="/blog/assets/js/app.6840529f.js" defer></script><script src="/blog/assets/js/2.11a5d5e3.js" defer></script><script src="/blog/assets/js/3.dc5724bf.js" defer></script><script src="/blog/assets/js/45.8158993f.js" defer></script><script src="/blog/assets/js/4.66589091.js" defer></script>
</body>
</html>
